<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Ruby Markup</title>
<meta name="description" content="How to use HTML5 markup to support ruby text for Asian languages." />
<script type="text/javascript">
var f = { }

// AUTHORS should fill in these assignments:
f.directory = 'articles/ruby'+'/'; // the path to this file, not including /International or the file name
f.filename = 'markup'; // the file name WITHOUT extensions
f.authors = 'Richard Ishida, W3C'; // author(s) and affiliations
f.previousauthors = ''; // as above
f.modifiers = ''; // people making substantive changes, and their affiliation
f.searchString = 'article-ruby-markup'; // blog search string - usually the filename without extensions
f.firstPubDate = '2016-06-14'; // date of the first publication of the document (after review)
f.lastSubstUpdate = { date:'2016-06-14', time:'18:40'}  // date and time of latest substantive changes to this document
f.status = 'published';  // should be one of draft, review, published, notreviewed or obsolete
f.path = '../../' // what you need to prepend to a URL to get to the /International directory 

// AUTHORS AND TRANSLATORS should fill in these assignments:
f.thisVersion = { date:'2016-07-18', time:'18:40'} // date and time of latest edits to this document/translation
f.contributors = 'Fantasai, Xidorn Quan, Addison Phillips'; // people providing useful contributions or feedback during review or at other times
// also make sure that the lang attribute on the html tag is correct!

// TRANSLATORS should fill in these assignments:
f.translators = 'xxxNAME, ORG'; // translator(s) and their affiliation - a elements allowed, but use double quotes for attributes

f.breadcrumb = 'markup';

f.additionalLinks = ''
</script>
<script type="text/javascript" src="markup-data/translations.js"> </script>
<script type="text/javascript" src="../../javascript/doc-structure/article-dt.js"> </script>
<script type="text/javascript" src="../../javascript/boilerplate-text/boilerplate-en.js"></script><!--TRANSLATORS must change -en to the subtag for their language!-->
<script type="text/javascript" src="../../javascript/doc-structure/article.js"> </script>
<script type="text/javascript" src="../../javascript/articletoc-html5.js"></script>
<link rel="stylesheet" href="../../style/article-2016.css" type="text/css" />
<link rel="copyright" href="#copyright"/>
<!--[if lt IE 9]><script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
<style>
.rubyExample { font-size: 50px; font-family: "ms mincho"; margin: 0; }
.el { color: #D61B1B; font-size: 120%; font-weight: 400; margin: 0 2px; }
.nowrap { white-space:nowrap; }
.sideinfonote .renderedExample { margin: 1em 0; font-size: 200%; text-align: center; }
.sideinfonote .renderedExample ruby { font-size: 100%; }
</style>
<script>
function highlightCode () {
	var examples = document.querySelectorAll('figure.example')
	for (var i=0;i<examples.length;i++) {
		var re = /&lt;([^&]+)&gt;/
		var content = examples[i].innerHTML
		out = content.replace(/&lt;([^&]+)&gt;/g,'<span class="el">&lt;$1&gt;</span>')
		examples[i].innerHTML = out
		}
	}
</script>
</head>

<body>
<header>
  <nav id="mainNavigation"></nav><script>document.getElementById('mainNavigation').innerHTML = mainNavigation</script>
  
  <h1>Ruby Markup</h1>
</header>


<section>
  <div id="audience">
    <p><span id="intendedAudience" class="leadin">Intended audience:</span> 
    HTML coders, script developers (PHP, JSP, etc.), CSS coders, and
      anyone who wants to know how to mark up ruby annotations. </p>
    <div id="updateInfo"></div><script>document.getElementById('updateInfo').innerHTML = g.updated</script>
    </div>
    
  <p>Ruby is the name given to the small annotations in Japanese and Chinese content that are rendered alongside base text, usually to provide phonetic information, but sometimes to provide other information. We will assume that you are familiar with how you want your ruby to look. (If not,  <a class="print" href="https://www.w3.org/International/questions/qa-ruby">see the short overview</a> of how ruby works.)</p>
    <aside class="insideinfonote">
  <p class="info">For a brief overview of what to expect when the browser renders the markup without CSS support, see the section <a href="#visual">What can I expect to see?</a> below.</p>
    </aside>
  <p>This article will only discuss how to use HTML5 <em>markup</em> for ruby text. The aim of markup is principally to <em>establish the relationships</em> between the <dfn>base text</dfn> and the <dfn>ruby text</dfn> (the annotations). For information about how to then apply adjustments to the default <em>styling</em> of ruby text, see <a href="styling.en" class="print"><cite>Ruby Styling</cite></a>.</p>
</section>


<section>
  <h2 id="Slide0090"><a href="#Slide0090">A simple example</a></h2>
  <p>Let's start out with a simple example, then we can discuss more detailed aspects later. Let's suppose we want to produce the following:</p>
  <figure>
  	<p lang="ja" class="rubyExample">これは<ruby><rb>日</rb><rt>に</rt><rb>本</rb><rt>ほん</rt><rb>語</rb><rt>ご</rt></ruby>です。</p>
  </figure>
  <p>Just below is some code that can produce this. The <code class="kw" translate="no">rb</code> element holds the ruby base, and the following <code class="kw" translate="no">rt</code> element holds the associated ruby text. </p>
 <aside class="insideinfonote">
  <p class="warning">The example contains spaces so that the source code wraps to the next line. In fact you need to be careful about this. According to the HTML spec, you can have spaces before <code class="kw" translate="no">rt</code> or <code class="kw" translate="no">rtc</code> tags, but not before <code class="kw" translate="no">rb</code> tags. However, some browsers currently add superfluous spaces to the rendered text if there are gaps or line breaks. For now, it's best to try to keep a whole ruby element on a single line, with no gaps, in the source code.</p>
</aside>
  <figure class="example">
  <p><code>これは&lt;ruby&gt;<span class="nowrap">&lt;rb&gt;日&lt;/rb&gt;&lt;rt&gt;に&lt;/rt&gt;</span>&#x0020;<span class="nowrap">&lt;rb&gt;本&lt;/rb&gt;&lt;rt&gt;ほん&lt;/rt&gt;</span>&#x0020;<span class="nowrap">&lt;rb&gt;語&lt;/rb&gt;&lt;rt&gt;ご&lt;/rt&gt;</span><span class="nowrap">&lt;/ruby&gt;です。</span></code></p>
    <div class="demolink"><a href="markup-data/eg_simple" target="text">Test in your browser.</a></div>
  </figure>
  <p>There are a number of ways to use  HTML markup to produce even this simple example. The code  above uses opening and closing tags for all elements, and uses tags for <code class="kw" translate="no">rb</code> elements, but we'll see in a moment that there are alternative approaches that use less markup, or move the markup around.</p>
  <p>Browsers will automatically position the annotations above the base characters in horizontal writing mode, and to the right in vertical writing mode. To change that you will need to use CSS (<code class="kw" translate="no">ruby-position</code>). That and other ways to alter the rendering of the ruby are discussed in the companion article, <a href="styling.en" class="print">Ruby Styling</a>.</p>
  </section>
  
  
<section>
<h2 id="tags"><a href="#tags">Tag strategies</a></h2>
<p>Before going further, let's look at some general patterns for markup that are defined as valid in HTML. This is about how much markup you need, and the order in which marked up items appear.</p>
<p>In the previous example we used <code class="kw" translate="no">rb</code> tags, and we opened and closed each element. If you feel that this makes it harder to read the source code or to create things manually, then the HTML5 specification allows a number of alternative approaches.</p>
	

  <section>
    <h3 id="inter"><a href="#inter">Interleaved markup</a></h3>
    <p> Both of the following alternatives are also valid. Note that the basic pattern here is <code class="kw" translate="no">ruby-base&#x202F;ruby-text&#x202F;ruby-base&#x202F;ruby-text&#x202F;...</code>, which we'll refer to as <span class="qterm">interleaved</span>.</p>
    <div class="sidenoteGroup">
    <figure class="example">
     <p><code>これは<span class="nowrap">&lt;ruby&gt;日&lt;rt&gt;に&lt;/rt&gt;本&lt;rt&gt;ほん&lt;/rt&gt;語&lt;rt&gt;ご&lt;/rt&gt;</span>&lt;/ruby&gt;です。</code></p>
    <div class="demolink"><a href="markup-data/eg_interleaved1" target="text">Test in your browser.</a></div>
</figure>
       <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> </span>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p class="impl">These two code samples produce ruby annotations above the relevant base text.</p>
      </aside>
</div>
     <div class="sidenoteGroup">
  <figure class="example">
      <p><code>これは<span class="nowrap">&lt;ruby&gt;&lt;rb&gt;日&lt;rt&gt;に&lt;rb&gt;本&lt;rt&gt;ほん&lt;rb&gt;語&lt;rt&gt;ご&lt;/ruby&gt;</span>です。</code></p>
    <div class="demolink"><a href="markup-data/eg_interleaved2" target="text">Test in your browser.</a></div>
    </figure>
      <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> </span>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
      </aside>
</div>
    <p>The first of the above examples drops the <code class="kw" translate="no">rb</code> tag, and is the style you will see in the examples in the HTML5 specification. The lower example drops the closing tags, resulting in the same simplification of markup, but making the <code class="kw" translate="no">rb</code> content directly selectable for styling or scripting.</p>
    <p>It is important to note, by the way, that you can no longer allow extra spaces to appear inside the <code class="kw" translate="no">ruby</code> element, since they will be produced in the output. You need to take care to ensure that your editor doesn't split the sequence across two or more lines while applying automatic source formatting!</p>
    <p>It is generally useful to include the <code class="kw" translate="no">rb</code> tag to help with styling. HTML does allow you to style ruby base content in a couple of alternative ways.  You could surround the <code class="kw" translate="no">rb</code> content with a <code class="kw" translate="no">span</code> element, although it's  easier and at the same time more semantically meaningful to use the <code class="kw" translate="no">rb</code> tag instead<code class="kw" translate="no"></code>. Another way is to style the <code class="kw" translate="no">ruby</code> element, then style the <code class="kw" translate="no">rt</code> tags differently. However, be aware that if the <code class="kw" translate="no">rb</code> content is not tagged, you won't be able to apply certain styling effects. (Bear in mind, also, that the need for such styling may not become apparent until a later date).</p>
<p>For example, research for elementary and junior-high students by the Japanese government in 2010 indicated that 0.2% of them have difficulty reading hiragana, and 6.9% have difficulty with kanji. Kanji dyslexia is related to difficulty in visual recognition of complex drawings, and therefore adding ruby adds complexity and makes them even harder to read. The researchers tried several methods to improve readability and found that the best method was to replace kanji (ie. the <code class="kw" translate="no">rb</code> text) with hiragana (ie. the <code class="kw" translate="no">rt</code> text).  Using CSS, a user or alternate style sheet can replace kanji with its annotation without having to change the markup (by hiding the <code class="kw" translate="no">rb</code> tags and making the <code class="kw" translate="no">rt</code> tags inline and full-size), but only if the <code class="kw" translate="no">rb</code> content is independently selectable.</p>
<p>So the conclusion here is that it's always better to use <code class="kw" translate="no">rb</code> tags.</p>
  </section>
  
  <section>
    <h3 id="tabular"><a href="#tabular">Tabular markup</a></h3>
    <p>There is  another way of arranging the components of a <code class="kw" translate="no">ruby</code> element. You can group all the ruby bases together and follow them with all the ruby text elements. The basic pattern here, then, is <code class="kw" translate="no">ruby-base&#x202F;ruby-base&#x202F;... ruby-text&#x202F;ruby-text&#x202F;...</code>, which we'll refer to as <span class="qterm">tabular</span>.</p>
    <p>One advantage to this approach is that it enables you to style the ruby text to appear inline in such a way that all the ruby text for a word follows that word together. Inline styling can be useful in space-constrained situations, where it would be too difficult to read small ruby characters.</p>
    <p>For example, if we take the interleaved example above and use CSS to make the ruby text appear inline, we will see something like:</p>
    <figure>
    <p lang="ja" class="rubyExample">日(に)本(ほん)語(ご)</p>
    </figure>
    <p>Usually, it would be preferable, while retaining the mapping of ruby text to individual base characters, to see:</p>
    <figure>
    <p lang="ja" class="rubyExample">日本語(にほんご)</p>
    </figure>
    <p> To achieve that, you can use the tabular approach  shown below.</p>
    <div class="sidenoteGroup">
    <figure class="example">
     <p><code>これは&lt;ruby&gt;&lt;rb&gt;日&lt;rb&gt;本&lt;rb&gt;語&lt;rt&gt;に&lt;rt&gt;ほん&lt;rt&gt;ご&lt;/ruby&gt;です。</code></p>
    <div class="demolink"><a href="markup-data/eg_tabular" target="text">Test in your browser.</a></div>
</figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all ruby annotations are displayed above the base.</p>
  </aside>
</div>
    <p>Each ruby base is now mapped to the same ruby text, but the order of elements has changed to be more like a tabular effect. You could visualise the markup like this:</p>
<figure>
<pre>[ruby]
[rb][rb][rb]
[rt][rt][rt]
[ruby]
</pre>
</figure>
<p>If you wanted, you could surround  the sequence of <code class="kw" translate="no">rt</code> elements with an <code class="kw" translate="no">rtc</code> element, but that is mostly needed when working with double-sided ruby (see below).</p>
<p>This tabular approach to marking up ruby also yields the expected results when a reader is searching for text in a page. If you are looking for the word <span lang="ja">日本語</span> you won't find it in ruby that uses the interleaved model (since the text being searched actually reads <span lang="ja">日に本ほん語ご</span>). You will find it, however, if ruby uses the tabular model described here (because the underlying text is <span lang="ja">日本語にほんご</span>).</p>
<p>In addition, the CSS Ruby specification which is in development, will place significant reliance on this model. For example, it is needed if styling is to be applied correctly for <a class="termref print" href="https://www.w3.org/International/questions/qa-ruby#jukugo">jukugo ruby</a>.</p>
    <!--p class="note"><strong>Note:</strong> It may appear that you could produce a similar effect by using group ruby, ie. by having a single annotation that reads <span lang="ja">にほんご</span> mapped to the whole word <span lang="ja">日本語</span>.  This would however be disadvantageous in at least a couple ways. You would lose the detailed semantics, you would severely limit your flexibility to style the ruby text, and you would encounter difficulties when justifying text. You would normally expect a sequence of annotated base characters to wrap  in the middle of a word when the end of the line is reached, but group ruby has to wrap as a single unit.</p-->
  </section>
 </section> 

<section>
<h2 id="visual"><a href="#visual">What can I expect to see?</a></h2>
<p>As mentioned above, this article is concerned with how you should mark up content to correctly establish relationships between ruby base and ruby text components, rather than how to lay it out when the page is rendered, and the  HTML5 specification's recommendations for the default style sheet don't go as far as indicating how to position ruby text relative to the base text. That is left to CSS, and we explore it further in the article <cite><a class="print" href="styling.en">Ruby Styling</a></cite>.</p>
<p>Having said that, however, you would expect the browser to be able to arrange simple ruby items visually in some sensible, albeit basic way, without  applying CSS properties.</p>
<p>All major browsers (by which read Chrome, Safari, Firefox, Edge and Internet Explorer) do position ruby text above horizontal base text when dealing with the simplest case, but handling varies when you move away from that.</p>
<p>At the time of writing, Firefox is by far the most advanced in this regard. It will produce sensible results for all the markup descriptions in this page. When two ruby texts are associated with a single base text, however, it displays both on one side. This is fair enough: you are expected to indicate alternative positions using the CSS <code class="kw" translate="no">ruby-position</code> property. It also has a bug when 'double-sided' ruby uses nested markup, and overlaps the two ruby texts.</p>
<p>The other browsers fail to produce a useful layout when dealing with 'double-sided' ruby, except that Chrome and Safari do something sensible with nested markup. They also fail to position items appropriately when tabular markup is used, even for simple cases (although they parse the markup correctly).</p>
<p>Finally, Edge and IE currently break down if you use only start tags inside the <code class="kw" translate="no">ruby</code> element.</p>
<p>All browsers allow you to style <code class="kw" translate="no">rb</code> tags, which can be useful for the use cases mentioned earlier.</p>
<p class="note">The Internationalization Working Group has produced a set of <a class="print" href="https://www.w3.org/International/tests/repo/results/ruby-html">tests with results</a> for  major browsers, covering the scenarios described in this page. The results are updated from time to time as browsers add more support.</p>
</section>

<section>
<h2 id="single"><a href="#single">Producing single-sided ruby</a></h2>
<p>This section tells you how to use markup for various types of single-sided ruby annotation, and covers various things to bear in mind. <strong>As mentioned above, there is more than one way to apply the markup – for the examples on this page, in order  to make  them clearer, we will use a consistent, minimal approach:  start tags only, but  <code class="kw" translate="no">rb</code> tags included. However, the pages you reach when clicking on &quot;Test in your browser&quot; are fully marked up with start and end tags.</strong></p>

<section>
    <h3 id="mono_group_etc"><a href="#mono_group_etc">Mono vs. group vs. jukugo</a></h3>
    <p>The most common approach when creating ruby  is to associate each base character with a single ruby annotation, ie. <a class="termref print" href="https://www.w3.org/International/questions/qa-ruby#mono">mono ruby</a>. (All of the earlier examples illustrate mono ruby.)</p>
    <p>Mono ruby makes it easy to handle line breaks when justifying text, since the browser can split the line between any two base characters. It also maps base characters and annotations precisely, and allows styling to apply the fine rendering control you may need. </p>
    <p><a class="termref print" href="https://www.w3.org/International/questions/qa-ruby#group">Group ruby</a>, on the other hand, assigns a single annotation to a sequence of base characters, and these base characters can no longer be split at the end of a line. Situations where group ruby is appropriate include sequences of base characters that are associated with a single phonetic sound, or semantic ruby that applies to a whole word, or even a phrase. </p>
    <p>Here is an example that shows group ruby on the left, and mono-ruby on the right. The two characters on the left are pronounced <span class="qterm">kyō</span>, which is an indivisible sound. Note the difference in how the annotations are distributed in relation to the base characters.</p>
    <figure>
      <p lang="ja" class="rubyExample"><ruby><rb>今日</rb><rt>きょう</rt></ruby>の<ruby><rb>会</rb><rt>かい</rt><rb>議</rb><rt>ぎ</rt></ruby></p>
    </figure>
    <p>To mark up group ruby you simply put more than one base character in the <code class="kw" translate="no">rb</code> tag, as shown in the following code sample.</p>
    <div class="sidenoteGroup">
   <figure class="example">
      <p><code>&lt;ruby&gt;&lt;rb&gt;今日&lt;rt&gt;きょう&lt;/ruby&gt;の&lt;ruby&gt;&lt;rb&gt;会&lt;rt&gt;かい&lt;rb&gt;議&lt;rt&gt;ぎ&lt;/ruby&gt;。</code></p>
    <div class="demolink"><a href="markup-data/eg_group_ruby" target="text">Test in your browser.</a></div>
    </figure>
        <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/> <span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> </span>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
      </aside>
</div>
   <div class="sidenoteGroup">
    <p>If you want to apply <a class="termref print" href="https://www.w3.org/International/questions/qa-ruby#jukugo">jukugo ruby</a> rules to your ruby text, you should  mark  up the content in the same way as mono ruby, using the tabular model*, and use one <code class="kw" translate="no">ruby</code> element per compound noun. </p>
    <aside class="sideinfonote">
    <p class="footnote">The CSS Ruby specification doesn't say it yet, but the current intention is to apply jukugo styling only to tabular markup. Unfortunately, as described above, tabular markup is not well supported at the moment, but this is also academic because jukugo ruby styling is still not well defined, much less implemented, at the moment.</p>
    </aside></div>
    <p>You don't need to worry about the overlaps in the markup. That will be taken care of by CSS. As previously mentioned, the markup simply estabishes the correspondances between base characters and annotations.</p>
  </section>
<section>
    <h3 id="bopomofo"><a href="#bopomofo">Bopomofo</a></h3>
    <p>Bopomofo, or zhuyin fuhao, characters used in ruby with Traditional Chinese characters are marked up in exactly the same way as mono ruby. No special markup is needed.</p>
    <div class="sidenoteGroup">
  <figure>
    <p><img src="markup-data/bopomofo.gif" alt="An example of ruby in Traditional Chinese script" width="359" height="115" /></p>
  </figure>
  <aside class="sideinfonote">
    <p class="info">The red coloring of the ruby text here is just to better show the position of the annotations in this example. There would not normally be a color difference. Note, in particular, how the tone marks appear to the right of the other bopomofo characters, even though they are not combining characters.</p></aside>
  </div>
    <p> You cannot expect bopomofo ruby to be aligned by default to the right of the base character. You will need to apply the appropriate CSS property. The markup merely establishes the relationships between the base characters and the ruby text. The positioning of the phonetic characters and tone marks to the right of the base character is achieved by styling. For example, the markup needed for the characters just above is as follows.</p>
<figure class="example">
	  <p lang="zh-hant"><code>&lt;ruby&gt;&lt;rb&gt;第&lt;rt&gt;ㄉㄧˋ&lt;rb&gt;十&lt;rt&gt;ㄕˊ&lt;rb&gt;屆&lt;rt&gt;ㄐㄧㄝˋ&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_bopomofo_ruby" target="text">Test in your browser.</a></div>
  </figure>
  </section>
  
  <section>
    <h3 id="gaps"><a href="#gaps">Gaps in the sequence</a></h3>
    <p>Occasionally you may want to mark up a sequence of base characters as a single ruby element when there is a non-kanji character in the middle of a word. Here is an example.</p>
  <figure>
  <p lang="ja" class="rubyExample"><ruby><rb>振</rb><rt>ふ</rt><rb>り</rb><rt></rt><rb>仮</rb><rt>が</rt><rb>名</rb><rt>な</rt></ruby></p>
  </figure>
  <p>One way to do this would be to use an empty <code class="kw" translate="no">rt</code> element after り. </p>
  <p>You could do this using an interleaved approach.</p>
  <div class="sidenoteGroup">
  <figure class="example">
  <p lang="ja"><code>&lt;ruby&gt;&lt;rb&gt;振&lt;rt&gt;ふ&lt;rb&gt;り&lt;rt&gt;&lt;rb&gt;仮&lt;rt&gt;が&lt;rb&gt;名&lt;rt&gt;な&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_gaps1" target="text">Test in your browser.</a></div>
  </figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <span class="issue">  <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/></span> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p>Annotations don't appear above base characters.</p>
  </aside>
</div>
  <div class="sidenoteGroup">
  <p>However, if you were to render the annotation inline, you'd have to ensure that your styling* removed anything that indicated the location of the missing character, so that you don't end up with   <span lang="ja">振（ふ）り（）仮（が）名（な）</span>. </p>
  <aside class="sideinfonote">
    <p class="footnote">You could hide parentheses with something like <code translate="no">rt:empty::before, rt:empty::after {content: none;}</code>.</p></aside>
  </div>
  <p>If you want the inlining to produce annotations grouped into words, you would use the tabular approach.</p>
  <div class="sidenoteGroup">
  <figure class="example">
    <p lang="ja"><code>&lt;ruby&gt;&lt;rb&gt;振&lt;rb&gt;り&lt;rb&gt;仮&lt;rb&gt;名&lt;rt&gt;ふ&lt;rt&gt;&lt;rt&gt;が&lt;rt&gt;な&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_gaps2" target="text">Test in your browser.</a></div>
  </figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/><img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Annotations don't appear above base characters. Edge puts all above the base, but the alignment is for group ruby.</p>
  </aside>
</div>
  <p>However,  now the result would be missing a character. You would see <span lang="ja">振り仮名（ふがな）</span>, instead of <span lang="ja">振り仮名（ふりがな）</span>. </p>
  <p>A better alternative would be to repeat the character in both the base and ruby text, and rely on CSS or the browser's default style sheet to automatically hide the annotation when both base and ruby text are the same. See <cite><a class="print" href="styling.en">Ruby Styling</a></cite> for details.</p>
  <div class="sidenoteGroup">
  <figure class="example">
  <p><code>&lt;ruby&gt;&lt;rb&gt;振&lt;rt&gt;ふ&lt;rb&gt;り&lt;rt&gt;り&lt;rb&gt;仮&lt;rt&gt;が&lt;rb&gt;名&lt;rt&gt;な&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_gaps3" target="text">Test in your browser.</a></div>
  </figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/><img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>The <code>り</code> is shown as an annotation.</p>
  </aside>
</div>
<div class="sidenoteGroup">
  <figure class="example">
    <p lang="ja"><code>&lt;ruby&gt;&lt;rb&gt;振&lt;rb&gt;り&lt;rb&gt;仮&lt;rb&gt;名&lt;rt&gt;ふ&lt;rt&gt;り&lt;rt&gt;が&lt;rt&gt;な&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_gaps4" target="text">Test in your browser.</a></div>
  </figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/><img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Annotations don't appear above base characters.</p>
    <p><img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/><img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>The <code>り</code> is shown as an annotation.</p>
  </aside>
</div>
  </section>
  
  <section>
    <h3 id="words"><a href="#words">How long should my <code class="kw" translate="no">ruby</code> element be?</a></h3>
    <p>Given the ability to string multiple ruby pairings together in a single <code class="kw" translate="no">ruby</code> element, the question arises as to what is the optimal number of pairings within any given <code class="kw" translate="no">ruby</code> element.</p>
    <p>You are free to decide this for yourself. If, however, you want to use a jukugo ruby arrangement some time in the future, you will need to establish clear word boundaries, so that annotations don't overlap adjacent words. This may also be important if you want to produce inline versions of your annotations, and you have used the tabular markup approach. That will ensure that the annotations appear after the words that they refer to. In these cases, you should start a new <code class="kw" translate="no">ruby</code> element for each word.</p>
    <p>Here is an example where compound nouns are annotated in separate <code class="kw" translate="no">ruby</code> elements. (We use a dotted red line to show the boundaries between each compound noun.)</p>
    <figure>
      <p lang="ja" class="rubyExample">
        <ruby style="border-right: 1px dashed red;"><rb>常</rb><rt>じょう</rt><rb>用</rb><rt>よう</rt></ruby><ruby style="border-right: 1px dashed red;"><rb>漢</rb><rt>かん</rt><rb>字</rb><rt>じ</rt></ruby><ruby style="border-right: 1px dashed red;"><rb>表</rb><rt>ひょう</rt></ruby>
      </p>
    </figure>
    <p>And here is one way to code it.</p>
<figure class="example">
      <p><code>&lt;ruby&gt;&lt;rb&gt;常&lt;rt&gt;じょう&lt;rb&gt;用&lt;rt&gt;よう&lt;/ruby&gt;<br>
      &lt;ruby&gt;&lt;rb&gt;漢&lt;rt&gt;かん&lt;rb&gt;字&lt;rt&gt;じ&lt;/ruby&gt;<br>
      &lt;ruby&gt;&lt;rb&gt;表&lt;rt&gt;ひょう&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_words_il" target="text">Test in your browser.</a></div>
</figure>
    

<p>If you want  inlined annotations appear on a word by word basis you would want to code using the tabular method. That would look like this.</p>
<figure class="example">
      <p><code>&lt;ruby&gt;&lt;rb&gt;常&lt;rb&gt;用&lt;rt&gt;じょう&lt;rt&gt;よう&lt;/ruby&gt;<br>
      &lt;ruby&gt;&lt;rb&gt;漢&lt;rb&gt;字&lt;rt&gt;かん&lt;rt&gt;じ&lt;/ruby&gt;<br>
      &lt;ruby&gt;&lt;rb&gt;表&lt;rt&gt;ひょう&lt;/ruby&gt;</code></p>
    <div class="demolink"><a href="markup-data/eg_words_tab" target="text">Test in your browser.</a></div>
</figure>
  </section>
</section>
  
  <section>
    <h2 id="double_sided"><a href="#double_sided">Producing double-sided ruby</a></h2>
    <p>Occasionally it is necessary to run annotations along two sides of the base text. This would be the case where there is both a phonetic and a semantic annotation, or where there are two types of phonetic annotation (such as bopomofo and pinyin as shown in the top left of the following screen grab).</p>
    <p><img src="markup-data/moedict-zi.png" width="430" height="271" alt=""/></p>
    <p class="note" style="clear: none;"><b>Note:</b> In this article we are just concerned with how to mark up the content. In order to display the two sets of ruby text on either side of the base text you will  have to use the <code class="kw" translate="no">ruby-position</code> property in CSS, since the HTML5 spec doesn't specify how to handle double-sided ruby by default. For more information, see the <a class="print" href="styling.en"><cite>Ruby Styling</cite></a> article.</p>
    
    <section>
    <h3 id="mono_only"><a href="#mono_only">Using mono ruby only</a></h3>
    <p>Let's look at a Japanese example where there is a regular one-to-one correspondence between the base characters and their two items of associated ruby text. </p>
    <figure>
      <p lang="ja" class="rubyExample"><img src="markup-data/double-mono.png" alt="東南(とうなん)(tounan)の方角" /></p>
    </figure>
    <p>One approach to coding this would be to use  tabular markup, but with an <code class="kw" translate="no">rtc</code> element around the second set of <code class="kw" translate="no">rt</code>s. You can visualize this as adding an additional row to the table, and the <code class="kw" translate="no">rtc</code> element shows where that starts.</p>
    <div class="sidenoteGroup">
    <figure>
      <pre>[ruby]
[rb][rb][rb]
[rt][rt][rt]
[rt][rt][rt]  &lt;-- rtc around this
[ruby]
      </pre>
    </figure>
    <aside class="sideinfonote">
    <p class="info">Actually, the markup model allows you to also put the <code class="kw" translate="no">rtc</code> tags around just the first set of <code class="kw" translate="no">rt</code>s, or around both.</p></aside>
    </div>
    <p>Here is the actual code. Note that you have to add an end tag for the <code class="kw" translate="no">rt</code> element before the end <code class="kw" translate="no">rtc</code> tag.</p>
    <div class="sidenoteGroup">
    <figure class="example">
     <p><code>&lt;ruby&gt;&lt;rb&gt;東&lt;rb&gt;南&lt;rt&gt;とう&lt;rt&gt;なん&lt;rtc&gt;&lt;rt&gt;tou&lt;rt&gt;nan&lt;/rt&gt;&lt;/rtc&gt;&lt;/ruby&gt;の方角 </code></p>
    <div class="demolink"><a href="markup-data/eg_dbl_mono" target="text">Test in your browser.</a></div>
    </figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p class="impl">Both annotations appear above the base and separate.</p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/><img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all annotations appear above the base.</p>
  </aside>
</div>
    
    <p>An alternative is to nest the <code class="kw" translate="no">ruby</code> elements. This would yield code like the following.</p>
<div class="sidenoteGroup">
    <figure class="example">
      <p><code>&lt;ruby&gt;&lt;ruby&gt;東&lt;rt&gt;とう&lt;/ruby&gt;&lt;rt&gt;tou&lt;rb&gt;&lt;ruby&gt;南&lt;rt&gt;なん&lt;/ruby&gt;&lt;rt&gt;nan&lt;/ruby&gt;の方角 </code></p>
    <div class="demolink"><a href="markup-data/eg_dbl_mono_nested" target="text">Test in your browser.</a></div>
    </figure>
  <aside class="implnote">
    <p><span class="issue"><span class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/></span> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <span class="impl"> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></span></p>
    <span class="impl">Both annotations appear above the base and separate.</span>
    <p><img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all annotations appear above the base.</p>
  </aside>
</div>
    </section>
    
    <section>
    <h3 id="mono_group"><a href="#mono_group">Using mono and group ruby together</a></h3>
    <p>When using double-sided ruby in Japanese you are probably more likely to need to combine mono ruby phonetics with group ruby semantics for a given word. This is also possible. Here is an example.</p>
    <figure>
      <p lang="ja" class="rubyExample"><img src="markup-data/double-mixed.png" alt="東南(とうなん)(tounan)の方角" /></p>
    </figure>
    <p>When using the tabular approach, you just put the group ruby text into a single <code class="kw" translate="no">rtc</code> element that spans the two base characters.</p>
    <div class="sidenoteGroup">
    <figure class="example">
      <p><code>&lt;ruby&gt;&lt;rb&gt;東&lt;/rb&gt;&lt;rb&gt;南&lt;rt&gt;とう&lt;rt&gt;なん&lt;rtc&gt;たつみ&lt;/rtc&gt;&lt;/ruby&gt;の方角 </code></p>
    <div class="demolink"><a href="markup-data/eg_dbl_mixed" target="text">Test in your browser.</a></div>
    </figure>
  <aside class="implnote">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p class="impl">Both annotations appear above the base and separate.</p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all annotations appear above the base.</p>
  </aside>
</div>

<p>When nesting, you bring more into the first <code class="kw" translate="no">ruby</code> element.</p>
<div class="sidenoteGroup">
    <figure class="example">
      <p><code>&lt;ruby&gt;&lt;ruby&gt;東&lt;rt&gt;とう&lt;rb&gt;南&lt;rt&gt;なん&lt;/ruby&gt;&lt;rt&gt;たつみ&lt;/ruby&gt;の方角 </code></p>
    <div class="demolink"><a href="markup-data/eg_dbl_mixed_nested" target="text">Test in your browser.</a></div>
    </figure>
  <aside class="implnote">
    <p><span class="issue"><span class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/></span> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <span class="impl"> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></span></p>
    <p class="impl">Both annotations appear above the base and separate.</p>
    <p class="impl"><img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all annotations appear above the base.</p>
  </aside>
</div>
    </section>
    
    <section>
    <h3 id="partial_overlap"><a href="#partial_overlap">Partially overlapping ruby</a></h3>
    <p>In some cases the annotation on one side of the base characters maps to a different set of characters than the annotation on the other side. For example.</p>
  <figure>
  <p><img src="markup-data/protego.png" width="140" height="105" alt=""/></p>
  </figure>
  <!--figure>
  <p style="font-size: 50px; font-family: 'ms mincho';"><ruby><ruby><rb>護</rb><rt>まも</rt><rb>れ</rb><rt></rt></ruby><rt>プロテゴ</rt></ruby>！</p>
  </figure>
  <figure>
  <p style="font-size: 50px; font-family: 'ms mincho';"><ruby><rb>護</rb><rb>れ</rb><rt>まも</rt><rt></rt><rtc>プロテゴ</rtc></ruby>！</p>
  </figure-->
  <div class="sidenoteGroup">
    <p>This is relatively straightforward when using the tabular approach, since it allows you to leave blank <code class="kw" translate="no">rt</code> elements where needed*.</p>
    <aside class="sideinfonote">
    <p class="footnote">Actually, in this example you could omit the empty <code class="kw" translate="no">rt</code> element altogether and it would still parse correctly. I have left it in so that the example shows the table-like structure more clearly.</p>
    </aside>
    </div>
    <div class="sidenoteGroup" style="clear:both;">
    <figure class="example">
     <p><code>&lt;ruby&gt;&lt;rb&gt;護&lt;rb&gt;れ&lt;rt&gt;まも&lt;rt&gt;&lt;/rt&gt;&lt;rtc&gt;プロテゴ&lt;/rtc&gt;&lt;/ruby&gt;！ </code></p>
    <div class="demolink"><a href="markup-data/eg_dbl_mismatch" target="text">Test in your browser.</a></div>
   </figure>
  <aside class="implnote" style="top:3em;">
    <p class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/>  <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></p>
    <p class="impl">Both annotations appear above the base and separate.</p>
    <p><span class="issue"><img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all annotations appear above the base.</p>
  </aside>
</div>
<p>When nesting, you can also achieve the effect required for the example above, but if group ruby were supposed to be on the top you would have to use CSS to reverse the normal positions of the annotations so that you could make the markup work. If the two annotations started and ended at different places, this would be much more difficult to manage.</p>
<div class="sidenoteGroup">
    <figure class="example">
      <p><code>&lt;ruby&gt;&lt;ruby&gt;&lt;rb&gt;護&lt;rt&gt;まも&lt;rb&gt;れ&lt;rt&gt;&lt;/rt&gt;&lt;/ruby&gt;&lt;rt&gt;プロテゴ&lt;/ruby&gt;！ </code></p>
    <div class="demolink"><a href="markup-data/eg_dbl_mismatch_nested" target="text">Test in your browser.</a></div>
    </figure>
  <aside class="implnote">
    <p><span class="issue"><span class="impl"><img src="../../icons/firefox_16x16.png" width="16" height="16" alt="Firefox" title="Firefox"/></span> <img src="../../icons/safari_16x16.png" width="16" height="16" alt="Safari" title="Safari"/></span> <img src="../../icons/chrome_16x16.png" width="16" height="16" alt="Chrome" title="Chrome"/> <img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/><span class="impl"> <img src="../../icons/ok.png" alt="OK" style="margin-left: 0.5em;"/></span></p>
    <p class="impl">Both annotations appear above the base and separate.</p>
    <p class="impl"><img src="../../icons/edge_16x16.png" width="16" height="16" alt="Edge" title="Edge"/> <img src="../../icons/fail.png" alt="fail" style="margin-left: 0.5em;"/></p>
    <p>Not all annotations appear above the base.</p>
  </aside>
</div>
    </section>
</section>


<section>
  <h2 id="endlinks"><a href="#endlinks">Further reading</a></h2>
<aside class="section" id="survey"> </aside><script>document.getElementById('survey').innerHTML = g.survey</script>

  <ul id="full-links">
    <li>
      <p><a href="https://www.w3.org/International/questions/qa-ruby">What is ruby?</a></p>
    </li>
    <li>
      <p>Related links, <cite>Authoring HTML &amp; CSS</cite></p>
      <ul>
        <li><a href="https://www.w3.org/International/techniques/authoring-html#ruby">Using ruby markup</a></li>
        <li><a href="https://www.w3.org/International/techniques/authoring-html#rubystyle">Styling ruby text</a></li>
      </ul>
    </li>
  </ul>
</section>

<footer id="thefooter"></footer><script type="text/javascript">document.getElementById('thefooter').innerHTML = g.bottomOfPage</script>
<script type="text/javascript">completePage(); highlightCode();</script>
</body>
</html>
